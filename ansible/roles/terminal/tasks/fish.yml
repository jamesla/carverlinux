# file: roles/fish/tasks/main.yml
---
- name: add fish repository
  apt_repository:
    repo: ppa:fish-shell/release-2

- name: install fish shell
  apt:
    name:
      - fish

- name: copy fish config
  become: false
  synchronize:
    src: "{{ role_path }}/files/.config"
    dest: ~/
    mode: pull

- name: set pam to allow shell change (possible bug in ubuntu 16)
  lineinfile:
    path: /etc/pam.d/chsh
    regexp: 'auth       required   pam_shells.so'
    line: '#auth       required   pam_shells.so'

- name: set as default shell
  become: true
  user:
    name: root
    shell: /usr/bin/fish

- name: set as default shell
  user:
    name: vagrant
    shell: /usr/bin/fish
