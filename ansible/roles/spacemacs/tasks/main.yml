# file: roles/spacemacs/tasks/main.yml
---
- name: install emacs and dependencies
  apt:
    name:
      - ispell
      - xclip
      - silversearcher-ag

- name: install ternjs #npm module currently in preview
  npm:
    global: yes
    name: "{{ item }}"
  with_items:
    - tern
    - js-yaml
    - vmd

- name: clone spacemacs
  become_user: vagrant
  git:
    repo: https://github.com/syl20bnr/spacemacs
    dest: ~/.emacs.d
    clone: yes
    update: no
  tags:
    - skip_ansible_lint

- name: copy spacemacs config
  become_user: vagrant
  copy:
    src: .spacemacs
    dest: ~/.spacemacs

- name: update spacemacs packages
  become_user: vagrant
  shell: emacs --batch --load=~/.emacs.d/init.el && touch /tmp/spacemacs_updated
  args:
    executable: /bin/bash
    creates: /tmp/spacemacs_updated
